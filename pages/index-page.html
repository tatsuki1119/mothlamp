<!-- <div class="contents_block">
    <h1 class="keep-all-break-word glitch-text" style="text-align: center; font-weight: normal; font-size: 2.4rem;">
        誘蛾灯の導き
    </h1>
    <p style="text-align: center;">ファントムシータ 非公式 ファンサイト</p>
</div> -->

<div id="kv-container">
    <div class="kv-sp">
        <div class="protected-img-wrapper">
            <img src="/static/kv-sp.jpeg" alt="誘蛾灯の導き kv-sp" class="protected-img">
        </div>
    </div>
    <div class="kv-pc">
        <div class="protected-img-wrapper">
            <img src="/static/kv-pc.jpeg" alt="誘蛾灯の導き kv-pc" class="protected-img">
        </div>
    </div>
</div>

<style>
    .kv-sp {
        display: block;
        aspect-ratio: 2476 / 2988;

        @media screen and (min-width: 767px) {
            display: none;
        }
    }

    .kv-pc {
        display: none;
        aspect-ratio: 5246 / 2988;

        @media screen and (min-width: 767px) {
            display: block;
        }
    }

    #kv-container {
        margin: 0 20px 20px 20px;
    }
</style>

<div class="contents_block">
    <p>
        <span class="word-chunk">
            <span class="word-chunk">本サイトのX(Twitter)アカウント</span>
            <span class="word-chunk"><a href="https://x.com/mothlamp_info" style="color: #ffcccc;">@mothlamp_info</a>
            </span>
            <span class="word-chunk">のフォローも</span><span class="word-chunk">お願いします！</span>
        </span>
        <span class="word-chunk">
            <span class="word-chunk">サイト内のコンテンツ更新の他、</span><span class="word-chunk">公式コンテンツの更新通知や</span>
            <span class="word-chunk">Web記事の紹介などを</span><span class="word-chunk">投稿しています。</span>
        </span>
    </p>
</div>

<div class="contents_block">
    <h3 class="glitch-text">公式リンク</h3>
    <ul id="official-link" class="official-link">
        <li>
            <a class="official-a" href="https://phantomsiita.com/?ref=mothlamp.info" target="_blank" rel="noreferrer">
                <svg role="img" aria-label="リボン">
                    <use href="#ribbon"></use>
                </svg>ホームページ</a>
        </li>
        <li>
            <a class="official-a" href="https://bonanza-base.com/shop/phantomsiita?ref=mothlamp.info" target="_blank"
                rel="noreferrer">
                <svg role="img" aria-label="リボン">
                    <use href="#ribbon"></use>
                </svg>Official Shop</a>
        </li>
        <li>
            <a class="official-a" href="https://x.com/PhantomSiita?ref=mothlamp.info" target="_blank">
                <svg role="img" aria-label="リボン">
                    <use href="#ribbon"></use>
                </svg>X(Twitter)</a>
        </li>
        <li>
            <a class="official-a" href="https://www.instagram.com/phantom_siita_official?ref=mothlamp.info"
                target="_blank">
                <svg role="img" aria-label="リボン">
                    <use href="#ribbon"></use>
                </svg>Instagram</a>
        </li>
        <li>
            <a class="official-a" href="https://www.youtube.com/@PhantomSiita?ref=mothlamp.info" target="_blank">
                <svg role="img" aria-label="リボン">
                    <use href="#ribbon"></use>
                </svg>YouTube</a>
        </li>
        <li>
            <a class="official-a" href="https://www.tiktok.com/@phantom_siita_official?ref=mothlamp.info"
                target="_blank">
                <svg role="img" aria-label="リボン">
                    <use href="#ribbon"></use>
                </svg>TikTok</a>
        </li>
        <li>
            <a class="official-a" href="https://piapro.jp/PhantomSiita?ref=mothlamp.info" target="_blank">
                <svg role="img" aria-label="リボン">
                    <use href="#ribbon"></use>
                </svg>piapro</a>
        </li>
    </ul>

    <hr>

    <ul class="official-link">
        <li class="mona-link">
            <a class="official-a" href="https://lit.link/psmona?ref=mothlamp.info" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>もな</a>
        </li>
        <li class="miu-link">
            <a class="official-a" href="https://lit.link/psmiu?ref=mothlamp.info" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>美雨</a>
        </li>
        <li class="rinka-link">
            <a class="official-a" href="https://lit.link/psrinka?ref=mothlamp.info" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>凛花</a>
        </li>
        <li class="moka-link">
            <a class="official-a" href="https://lit.link/psmoka?ref=mothlamp.info" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>百花</a>
        </li>
    </ul>
</div>


<div class="contents_block contents_block_has_a">
    <a class="contents_block_a" href="/?p=play.haine-test-2"></a>
    <img src="/static/img/haine-test-2.jpg" alt="">
    <h2>
        <span class="word-chunk">第２回ハイネ共通テスト</span>
    </h2>
</div>


<div class="contents_block contents_block_has_a phanart-link-block">
    <a class="contents_block_a" href="/?p=phanart"></a>
    <h2 class="glitch-text">ファンアート</h2>
    <p class="keep-all-break-word">絵師さんによる素敵なファンアートを<wbr>紹介します！</p>
    <div class="phanart-slider-container">
        <div class="phanart-slider">
            <img src="/static/img/phanart/guoxoua/000-top.jpg" alt="" class="phanart-link-img">
            <img src="/static/img/phanart/oan/000-top.jpg" alt="" class="phanart-link-img">
            <img src="/static/img/phanart/sanketsu/000-top.jpg" alt="" class="phanart-link-img">
        </div>
    </div>
    <script>
        // スライダー内の画像を複製
        var sliderContainer = $('.phanart-slider-container');
        var slider = $('.phanart-slider');
        sliderContainer.append(slider.clone()).append(slider.clone()).append(slider.clone()).append(slider.clone());
    </script>
</div>

<div class="contents_block">
    <h3 class="glitch-text">スケジュール</h3>
    <p style="font-size: xx-small;">
        <span class="word-chunk">
            ※ 公式ではないため、間違いがある可能性があります。
        </span>
        <span class="word-chunk">
            あらかじめご了承ください。
        </span>
    </p>
    <hr class="hr-no-margin">
    <div id="schedule-loading" class="list-loading">
        <svg role="img" aria-label="リボン">
            <use href="#butterfly"></use>
        </svg>
        Loading...
        <svg role="img" aria-label="リボン">
            <use href="#butterfly"></use>
        </svg>
    </div>
    <ul id="schedule" class="link-list">
    </ul>
    <div class="link-btn-div">
        <a href="/?p=schedule" class="link-btn-a">すべて見る</a>
    </div>
    <script>
        $(document).ready(function () {
            // 既に実行済みなら終了
            if (window.__scheduleLoaded) return;
            window.__scheduleLoaded = true;

            const apiurl = "https://g-api.mothlamp.info/api";
            const target_sheet = "schedule";
            const url = apiurl + "?target=" + target_sheet;

            $.getJSON(url, function (data) {
                renderSchedule(data);
            });

            // スケジュールを描画する関数（JSTの現在日時以降の3件のみ表示）
            function renderSchedule(data) {
                const youbiArray = ['日', '月', '火', '水', '木', '金', '土'];

                // JSTの現在日時を取得
                const now = new Date();
                const jstNow = new Date(now.toLocaleString("en-US", { timeZone: "Asia/Tokyo" }));

                let count = 0;

                for (let i = 0; i < data.length; i++) {
                    if (count >= 3) break;

                    const schedule = data[i];

                    // 日時をJSTとして変換
                    const scheduleDate = new Date(new Date(schedule.date).toLocaleString("en-US", { timeZone: "Asia/Tokyo" }));

                    // 当日以降か判定（時刻は無視して日付だけで比較）
                    const jstToday = new Date(jstNow.getFullYear(), jstNow.getMonth(), jstNow.getDate());
                    const scheduleDay = new Date(scheduleDate.getFullYear(), scheduleDate.getMonth(), scheduleDate.getDate());

                    if (scheduleDay >= jstToday) {
                        // フォーマット（例：2025.07.20）
                        const year = scheduleDate.getFullYear();
                        const month = String(scheduleDate.getMonth() + 1).padStart(2, '0');
                        const day = String(scheduleDate.getDate()).padStart(2, '0');
                        const formattedDate = `${year}.${month}.${day}`;
                        const dayOfWeek = youbiArray[scheduleDate.getDay()];

                        const listItem = `
                            <a href="/?p=schedule_detail&sc=${schedule.index}" class="link-list-a">
                                <li>
                                    <p class="date">
                                        <svg role="img" aria-label="蝶々">
                                            <use href="#butterfly"></use>
                                        </svg>${formattedDate}（${dayOfWeek}）【${String(schedule.tag).toUpperCase()}】
                                    </p>
                                    <p class="title">${schedule.title}</p>
                                </li>
                            </a>
                        `;
                        $('#schedule').append(listItem);
                        count++;
                    }
                }

                $('#schedule-loading').hide();
            }
        });
    </script>
</div>

<div class="contents_block">
    <h3 class="glitch-text">まとめ記事</h3>
    <hr class="hr-no-margin">
    <ul id="articles" class="link-list">
    </ul>
    <div class="link-btn-div">
        <a href="/?p=articles" class="link-btn-a">すべて見る</a>
    </div>
    <script>
        const articles_json_path = `/pages/data/articles-data.json?nocache=${new Date().getTime()}`;

        // 記事データを取得して表示
        $(document).ready(function () {
            // 既に実行済みなら終了
            if (window.__articlesLoaded) return;
            window.__articlesLoaded = true;

            var queryString = window.location.search;
            var urlParams = new URLSearchParams(queryString);
            var pathQuery = urlParams.get('p');


            $.getJSON(articles_json_path, function (data) {
                data.forEach(function (data_i) {
                    // privateではないデータのみ
                    if (!data_i.private) {
                        // show-index が true のデータのみ処理
                        if (data_i.show_index) {
                            const listItem = `
                                <a href="/?p=articles.${data_i.p}" class="link-list-a">
                                    <li>
                                        <p>
                                            <svg role="img" aria-label="蝶々">
                                                <use href="#butterfly"></use>
                                            </svg>${data_i.title}
                                        </p>
                                    </li>
                                </a>
                            `;
                            $('#articles').append(listItem);
                        }
                    }
                });
            });
        });
    </script>
</div>

<div class="contents_block">
    <h3 class="glitch-text">Web記事</h3>
    <hr class="hr-no-margin">
    <div id="web-loading" class="list-loading">
        <svg role="img" aria-label="リボン">
            <use href="#butterfly"></use>
        </svg>
        Loading...
        <svg role="img" aria-label="リボン">
            <use href="#butterfly"></use>
        </svg>
    </div>
    <ul id="web" class="link-list">
    </ul>
    <div class="link-btn-div">
        <a href="/?p=web" class="link-btn-a">すべて見る</a>
    </div>
    <script>
        $(document).ready(function () {
            // 既に実行済みなら終了
            if (window.__webArticlesLoaded) return;
            window.__webArticlesLoaded = true;

            const apiurl = "https://g-api.mothlamp.info/api";
            const target_sheet = "web-articles";
            const url = apiurl + "?target=" + target_sheet;

            $.getJSON(url, function (data) {
                renderArticles(data);
            });

            // 記事を描画する関数
            function renderArticles(data) {
                for (let i = 0; i < data.length && i < 3; i++) {
                    const web = data[i];
                    const listItem = `
                    <a href="${web.url}" target="_blank" class="link-list-a">
                        <li>
                            <p class="date">
                                <svg role="img" aria-label="蝶々">
                                    <use href="#butterfly"></use>
                                </svg>${web.date}
                            </p>
                            <p class="title">${web.title}</p>
                            <p class="media">${web.media}</p>
                            ${web.local_link ? `<a href="/?p=web.${web.local_link}" class="local-link-a local">記事へ</a>` : ''}
                        </li>
                    </a>
                `;
                    $('#web').append(listItem);
                }
                $('#web-loading').hide();
            }
        });
    </script>

</div>


<div class="contents_block">
    <h3 class="glitch-text">お知らせ</h3>
    <hr>
    <style>
        .notice-div {
            margin: 1% 2%;
        }
    </style>

    <div id="notice"></div>


    <script>
        const notice_json_path = `./pages/data/notice-data.json?nocache=${new Date().getTime()}`;

        $(document).ready(function () {

            $.getJSON(notice_json_path, function (data) {
                data
                    .slice() // 元配列を壊さない
                    .sort(function (a, b) {
                        return b.id - a.id; // 新しい順
                    })
                    .slice(0, 3) // 上位3件
                    .forEach(function (data_i) {
                        const dateText =
                            data_i.id.substring(0, 4) + '.' +
                            data_i.id.substring(4, 6) + '.' +
                            data_i.id.substring(6, 8);
                        let contentsHtml = '';
                        data_i.contents.forEach(function (content) {
                            contentsHtml += `<p>${content}</p>`;
                        });
                        const html = `
                        <div class="notice-div">
                            <svg role="img" aria-label="蝶々">
                                <use href="#butterfly"></use>
                            </svg>${dateText}
                            ${contentsHtml}
                        </div>
                        <hr>
                    `;
                        $('#notice').append(html);
                    });
            });
        });
    </script>


    <div class="link-btn-div">
        <a href="/?p=notice" class="link-btn-a">すべて見る</a>
    </div>
</div>


<div class="contents_block">
    <h3 class="glitch-text">遊びコンテンツ</h3>
    <hr class="hr-no-margin">

    <ul class="link-list">

        <a href="/?p=play.haine-grave" class="link-list-a">
            <li>
                <p>
                    <svg role="img" aria-label="蝶々">
                        <use href="#butterfly"></use>
                    </svg>ハイネ墓地
                </p>
            </li>
        </a>
        <a href="/?p=play.raffle-sim" class="link-list-a">
            <li>
                <p>
                    <svg role="img" aria-label="蝶々">
                        <use href="#butterfly"></use>
                    </svg>ランダムくじ(ガチャ)シミュレーター
                </p>
            </li>
        </a>
        <a href="/?p=play.haine-test" class="link-list-a">
            <li>
                <p>
                    <svg role="img" aria-label="蝶々">
                        <use href="#butterfly"></use>
                    </svg>第1回ハイネ共通テスト(2025.04.03)
                </p>
            </li>
        </a>
        <a href="/?p=play.haine-test-2" class="link-list-a">
            <li>
                <p>
                    <svg role="img" aria-label="蝶々">
                        <use href="#butterfly"></use>
                    </svg>第2回ハイネ共通テスト(2026.01.17)
                </p>
            </li>
        </a>

    </ul>

    <br>
    <h3 class="glitch-text">便利ツール</h3>
    <hr class="hr-no-margin">

    <ul class="link-list">

        <a href="/?p=watermark" class="link-list-a">
            <li>
                <p>
                    <svg role="img" aria-label="蝶々">
                        <use href="#butterfly"></use>
                    </svg>透かし加工
                </p>
            </li>
        </a>

    </ul>
</div>
