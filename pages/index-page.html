<!-- <div class="contents_block">
    <h1 class="keep-all-break-word glitch-text" style="text-align: center; font-weight: normal; font-size: 2.4rem;">
        誘蛾灯の導き
    </h1>
    <p style="text-align: center;">ファントムシータ 非公式 ファンサイト</p>
</div> -->

<div id="kv-container">
    <div class="kv-sp">
        <div class="protected-img-wrapper">
            <img src="/static/kv-sp.jpeg" alt="誘蛾灯の導き kv-sp" class="protected-img">
        </div>
    </div>
    <div class="kv-pc">
        <div class="protected-img-wrapper">
            <img src="/static/kv-pc.jpeg" alt="誘蛾灯の導き kv-pc" class="protected-img">
        </div>
    </div>
</div>

<style>
    .kv-sp {
        display: block;

        @media screen and (min-width: 767px) {
            display: none;
        }
    }

    .kv-pc {
        display: none;

        @media screen and (min-width: 767px) {
            display: block;
        }
    }

    #kv-container {
        margin: 0 20px 20px 20px;
    }
</style>

<div class="contents_block">
    <p>
        <span class="word-chunk">
            <span class="word-chunk">本サイトのX(Twitter)アカウント</span>
            <span class="word-chunk"><a href="https://x.com/mothlamp_info" style="color: #ffcccc;">@mothlamp_info</a>
            </span>
            <span class="word-chunk">のフォローも</span><span class="word-chunk">お願いします！</span>
        </span>
        <span class="word-chunk">
            <span class="word-chunk">サイト内のコンテンツ更新の他、</span><span class="word-chunk">公式コンテンツの更新通知や</span>
            <span class="word-chunk">Web記事の紹介などを</span><span class="word-chunk">投稿しています。</span>
        </span>
    </p>
</div>

<div class="contents_block">
    <h3 class="glitch-text">公式リンク</h3>
    <ul id="official-link" class="official-link">
        <li>
            <a class="official-a" href="https://phantomsiita.com/" target="_blank" rel="noreferrer">
                <svg role="img" aria-label="リボン">
                    <use href="#ribbon"></use>
                </svg>ホームページ</a>
        </li>
        <li>
            <a class="official-a" href="https://bonanza-base.com/shop/phantomsiita" target="_blank" rel="noreferrer">
                <svg role="img" aria-label="リボン">
                    <use href="#ribbon"></use>
                </svg>Official Shop</a>
        </li>
        <li>
            <a class="official-a" href="https://x.com/PhantomSiita" target="_blank">
                <svg role="img" aria-label="リボン">
                    <use href="#ribbon"></use>
                </svg>X(Twitter)</a>
        </li>
        <li>
            <a class="official-a" href="https://www.instagram.com/phantom_siita_official" target="_blank">
                <svg role="img" aria-label="リボン">
                    <use href="#ribbon"></use>
                </svg>Instagram</a>
        </li>
        <li>
            <a class="official-a" href="https://www.youtube.com/@PhantomSiita" target="_blank">
                <svg role="img" aria-label="リボン">
                    <use href="#ribbon"></use>
                </svg>YouTube</a>
        </li>
        <li>
            <a class="official-a" href="https://www.tiktok.com/@phantom_siita_official" target="_blank">
                <svg role="img" aria-label="リボン">
                    <use href="#ribbon"></use>
                </svg>TikTok</a>
        </li>
        <li>
            <a class="official-a" href="https://piapro.jp/PhantomSiita" target="_blank">
                <svg role="img" aria-label="リボン">
                    <use href="#ribbon"></use>
                </svg>piapro</a>
        </li>
    </ul>

    <hr>

    <ul class="official-link mona-link">
        <li>
            <a class="official-a" href="https://lit.link/psmona" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>もな</a>
        </li>
        <li>
            <a class="official-a" href="https://x.com/ps_mona0917" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>X(Twitter)</a>
        </li>
        <li>
            <a class="official-a" href="https://www.instagram.com/ps_mona0917" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>Instagram</a>
        </li>
        <li>
            <a class="official-a" href="https://www.tiktok.com/@ps_mona0917" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>TikTok</a>
        </li>
    </ul>

    <ul class="official-link miu-link" style="padding-top: 0;">
        <li>
            <a class="official-a" href="https://lit.link/psmiu" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>美雨</a>
        </li>
        <li>
            <a class="official-a" href="https://x.com/ps_miu1117" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>X(Twitter)</a>
        </li>
        <li>
            <a class="official-a" href="https://www.instagram.com/ps_miu1117" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>Instagram</a>
        </li>
        <li>
            <a class="official-a" href="https://www.tiktok.com/@ps_miu1117" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>TikTok</a>
        </li>
    </ul>

    <ul class="official-link rinka-link" style="padding-top: 0;">
        <li>
            <a class="official-a" href="https://lit.link/psrinka" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>凛花</a>
        </li>
        <li>
            <a class="official-a" href="https://x.com/ps_rinka0509" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>X(Twitter)</a>
        </li>
        <li>
            <a class="official-a" href="https://www.instagram.com/ps_rinka0509" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>Instagram</a>
        </li>
        <li>
            <a class="official-a" href="https://www.tiktok.com/@ps_rinka0509" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>TikTok</a>
        </li>
    </ul>

    <!-- <ul class="official-link hisui-link" style="padding-top: 0;">
        <li>
            <a class="official-a" href="https://lit.link/pshisui" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>灯翠</a>
        </li>
        <li>
            <a class="official-a" href="https://x.com/ps_hisui0501" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>X(Twitter)</a>
        </li>
        <li>
            <a class="official-a" href="https://www.instagram.com/ps_hisui0501" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>Instagram</a>
        </li>
        <li>
            <a class="official-a" href="https://www.tiktok.com/@ps_hisui0501" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>TikTok</a>
        </li>
    </ul> -->

    <ul class="official-link moka-link" style="padding-top: 0;">
        <li>
            <a class="official-a" href="https://lit.link/psmoka" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>百花</a>
        </li>
        <li>
            <a class="official-a" href="https://x.com/ps_moka1020" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>X(Twitter)</a>
        </li>
        <li>
            <a class="official-a" href="https://www.instagram.com/ps_moka1020" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>Instagram</a>
        </li>
        <li>
            <a class="official-a" href="https://www.tiktok.com/@ps_moka1020" target="_blank">
                <svg role="img" aria-label="蝶々">
                    <use href="#butterfly"></use>
                </svg>TikTok</a>
        </li>
    </ul>

</div>

<div class="contents_block contents_block_has_a phanart-link-block">
    <a class="contents_block_a" href="/?p=phanart"></a>
    <h2 class="glitch-text">ファンアート</h2>
    <p class="keep-all-break-word">絵師さんによる素敵なファンアートを<wbr>紹介します！</p>
    <div class="phanart-slider-container">
        <div class="phanart-slider">
            <img src="/static/img/phanart/guoxoua/000-cover.jpg" alt="" class="phanart-link-img">
            <img src="/static/img/phanart/oan/000-cover.jpg" alt="" class="phanart-link-img">
        </div>
    </div>
    <script>
        // スライダー内の画像を複製
        var sliderContainer = $('.phanart-slider-container');
        var slider = $('.phanart-slider');
        sliderContainer.append(slider.clone()).append(slider.clone()).append(slider.clone()).append(slider.clone());
    </script>
</div>

<div class="contents_block">
    <h3 class="glitch-text">スケジュール</h3>
    <p style="font-size: xx-small;">
        <span class="word-chunk">
            ※ 公式ではないため、間違いがある可能性があります。
        </span>
        <span class="word-chunk">
            あらかじめご了承ください。
        </span>
    </p>
    <hr class="hr-no-margin">
    <div id="schedule-loading" class="list-loading">
        <svg role="img" aria-label="リボン">
            <use href="#butterfly"></use>
        </svg>
        Loading...
        <svg role="img" aria-label="リボン">
            <use href="#butterfly"></use>
        </svg>
    </div>
    <ul id="schedule" class="link-list">
    </ul>
    <div class="link-btn-div">
        <a href="/?p=schedule" class="link-btn-a">すべて見る</a>
    </div>
    <script>
        $(document).ready(function () {
            const apiurl = "https://script.google.com/macros/s/AKfycbzVQzDXTeXn9TbXnWo5t41PaviWk5ui7gIGGC3pKdPOE4TaSYBZvlBCS23FpDaaUhmB/exec";
            const target_sheet = "schedule";
            const url = apiurl + "?target=" + target_sheet;

            // キャッシュ保持時間（ミリ秒）
            const CACHE_DURATION = 12 * 60 * 60 * 1000;
            const CACHE_KEY = "schedule_cache";
            const TIMESTAMP_KEY = "schedule_cache_time";

            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            const pathQuery = urlParams.get('p');

            if (!pathQuery) { // index のときだけ実行
                const cachedData = sessionStorage.getItem(CACHE_KEY);
                const cachedTime = sessionStorage.getItem(TIMESTAMP_KEY);
                const now = new Date().getTime();

                if (cachedData && cachedTime && (now - cachedTime < CACHE_DURATION)) {
                    // セッションキャッシュが有効な場合
                    const data = JSON.parse(cachedData);
                    renderSchedule(data);
                } else {
                    // キャッシュがない、または期限切れの場合
                    $.getJSON(url, function (data) {
                        // セッションキャッシュ保存
                        sessionStorage.setItem(CACHE_KEY, JSON.stringify(data));
                        sessionStorage.setItem(TIMESTAMP_KEY, now.toString());

                        renderSchedule(data);
                    });
                }
            }

            // スケジュールを描画する関数（JSTの現在日時以降の3件のみ表示）
            function renderSchedule(data) {
                const youbiArray = ['日', '月', '火', '水', '木', '金', '土'];

                // JSTの現在日時を取得
                const now = new Date();
                const jstNow = new Date(now.toLocaleString("en-US", { timeZone: "Asia/Tokyo" }));

                let count = 0;

                for (let i = 0; i < data.length; i++) {
                    if (count >= 3) break;

                    const schedule = data[i];

                    // 日時をJSTとして変換
                    const scheduleDate = new Date(new Date(schedule.date).toLocaleString("en-US", { timeZone: "Asia/Tokyo" }));

                    // 当日以降か判定（時刻は無視して日付だけで比較）
                    const jstToday = new Date(jstNow.getFullYear(), jstNow.getMonth(), jstNow.getDate());
                    const scheduleDay = new Date(scheduleDate.getFullYear(), scheduleDate.getMonth(), scheduleDate.getDate());

                    if (scheduleDay >= jstToday) {
                        // フォーマット（例：2025.07.20）
                        const year = scheduleDate.getFullYear();
                        const month = String(scheduleDate.getMonth() + 1).padStart(2, '0');
                        const day = String(scheduleDate.getDate()).padStart(2, '0');
                        const formattedDate = `${year}.${month}.${day}`;
                        const dayOfWeek = youbiArray[scheduleDate.getDay()];

                        const listItem = `
                            <a href="/?p=schedule_detail&sc=${schedule.index}" class="link-list-a">
                                <li>
                                    <p class="date">
                                        <svg role="img" aria-label="蝶々">
                                            <use href="#butterfly"></use>
                                        </svg>${formattedDate}（${dayOfWeek}）【${String(schedule.tag).toUpperCase()}】
                                    </p>
                                    <p class="title">${schedule.title}</p>
                                </li>
                            </a>
                        `;
                        $('#schedule').append(listItem);
                        count++;
                    }
                }

                $('#schedule-loading').hide();
            }
        });
    </script>
</div>

<div class="contents_block">
    <h3 class="glitch-text">まとめ記事</h3>
    <hr class="hr-no-margin">
    <ul id="articles" class="link-list">
    </ul>
    <div class="link-btn-div">
        <a href="/?p=articles" class="link-btn-a">すべて見る</a>
    </div>
    <script>
        const articles_json_path = `/pages/articles/articles-data.json?nocache=${new Date().getTime()}`;

        // 記事データを取得して表示
        $(document).ready(function () {
            var queryString = window.location.search;
            var urlParams = new URLSearchParams(queryString);
            var pathQuery = urlParams.get('p');

            if (!(pathQuery)) { // indexの時だけ
                $.getJSON(articles_json_path, function (data) {
                    data.forEach(function (data_i) {
                        // privateではないデータのみ
                        if (!data_i.private) {
                            // show-index が true のデータのみ処理
                            if (data_i.show_index) {
                                const listItem = `
                                <a href="/?p=articles.${data_i.p}" class="link-list-a">
                                    <li>
                                        <p>
                                            <svg role="img" aria-label="蝶々">
                                                <use href="#butterfly"></use>
                                            </svg>${data_i.title}
                                        </p>
                                    </li>
                                </a>
                            `;
                                $('#articles').append(listItem);
                            }
                        }
                    });
                });
            }
        });
    </script>
</div>

<div class="contents_block">
    <h3 class="glitch-text">Web記事</h3>
    <hr class="hr-no-margin">
    <div id="web-loading" class="list-loading">
        <svg role="img" aria-label="リボン">
            <use href="#butterfly"></use>
        </svg>
        Loading...
        <svg role="img" aria-label="リボン">
            <use href="#butterfly"></use>
        </svg>
    </div>
    <ul id="web" class="link-list">
    </ul>
    <div class="link-btn-div">
        <a href="/?p=web" class="link-btn-a">すべて見る</a>
    </div>
    <script>
        $(document).ready(function () {
            const apiurl = "https://script.google.com/macros/s/AKfycbzVQzDXTeXn9TbXnWo5t41PaviWk5ui7gIGGC3pKdPOE4TaSYBZvlBCS23FpDaaUhmB/exec";
            const target_sheet = "web-articles";
            const url = apiurl + "?target=" + target_sheet;

            // キャッシュ保持時間（ミリ秒）
            const CACHE_DURATION = 12 * 60 * 60 * 1000;
            const CACHE_KEY = "web_articles_cache";
            const TIMESTAMP_KEY = "web_articles_cache_time";

            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            const pathQuery = urlParams.get('p');

            if (!pathQuery) { // index のときだけ実行
                const cachedData = sessionStorage.getItem(CACHE_KEY);
                const cachedTime = sessionStorage.getItem(TIMESTAMP_KEY);
                const now = new Date().getTime();

                if (cachedData && cachedTime && (now - cachedTime < CACHE_DURATION)) {
                    // セッションキャッシュが有効な場合
                    const data = JSON.parse(cachedData);
                    renderArticles(data);
                } else {
                    // キャッシュがない、または期限切れの場合
                    $.getJSON(url, function (data) {
                        // セッションキャッシュ保存
                        sessionStorage.setItem(CACHE_KEY, JSON.stringify(data));
                        sessionStorage.setItem(TIMESTAMP_KEY, now.toString());

                        renderArticles(data);
                    });
                }
            }

            // 記事を描画する関数
            function renderArticles(data) {
                for (let i = 0; i < data.length && i < 3; i++) {
                    const web = data[i];
                    const listItem = `
                    <a href="${web.url}" target="_blank" class="link-list-a">
                        <li>
                            <p class="date">
                                <svg role="img" aria-label="蝶々">
                                    <use href="#butterfly"></use>
                                </svg>${web.date}
                            </p>
                            <p class="title">${web.title}</p>
                            <p class="media">${web.media}</p>
                            ${web.local_link ? `<a href="/?p=web.${web.local_link}" class="local-link-a local">記事へ</a>` : ''}
                        </li>
                    </a>
                `;
                    $('#web').append(listItem);
                }
                $('#web-loading').hide();
            }
        });
    </script>

</div>


<div class="contents_block">
    <h3 class="glitch-text">お知らせ</h3>
    <hr>
    <style>
        .notice-div {
            margin: 1% 2%;
        }
    </style>

    <div class="notice-div">
        <svg role="img" aria-label="蝶々">
            <use href="#butterfly"></use>
        </svg>2025.06.26
        <p>トップページにメンバーのSNSリンクを追加しました。</p>
    </div>
    <hr>

    <div class="notice-div">
        <svg role="img" aria-label="蝶々">
            <use href="#butterfly"></use>
        </svg>2025.05.31
        <p><a href="/?p=phanart.hisui-special">灯翠さん ファンアート</a> まとめページを公開しました。</p>
    </div>
    <hr>

    <div class="notice-div">
        <svg role="img" aria-label="蝶々">
            <use href="#butterfly"></use>
        </svg>2025.04.03
        <p><a href="/?p=play.haine-test">ハイネ共通テスト</a>
            を公開しました。</p>
    </div>
    <hr>

    <div class="link-btn-div">
        <a href="/?p=notice" class="link-btn-a">すべて見る</a>
    </div>
</div>


<div class="contents_block">
    <h3 class="glitch-text">遊びコンテンツ</h3>
    <hr class="hr-no-margin">

    <ul class="link-list">

        <a href="/?p=play.haine-grave" class="link-list-a">
            <li>
                <p>
                    <svg role="img" aria-label="蝶々">
                        <use href="#butterfly"></use>
                    </svg>ハイネ墓地
                </p>
            </li>
        </a>
        <a href="/?p=play.haine-test" class="link-list-a">
            <li>
                <p>
                    <svg role="img" aria-label="蝶々">
                        <use href="#butterfly"></use>
                    </svg>ハイネ共通テスト
                </p>
            </li>
        </a>

    </ul>
    <!-- <div class="link-btn-div">
        <a href="/?p=play" class="link-btn-a">すべて見る</a>
    </div> -->
</div>
