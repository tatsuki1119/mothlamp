<div id="page-title" style="display: none;">お知らせ [誘蛾灯の導き]</div>
<div id="page-description" style="display: none;">「誘蛾灯の導き」からのお知らせです。</div>

<div class="contents_block">
    <h1 class="glitch-text">お知らせ</h1>
</div>


<div id="notice"></div>


<script>
    const notice_json_path = `./pages/data/notice-data.json?nocache=${new Date().getTime()}`;

    // お知らせデータを取得して表示
    $(document).ready(function () {
        var queryString = window.location.search;
        var urlParams = new URLSearchParams(queryString);
        var pathQuery = urlParams.get('p');

        $.getJSON(notice_json_path, function (data) {
            data.slice().reverse().forEach(function (data_i) {

                // id (YYYYMMDD) → YYYY.MM.DD
                const dateText =
                    data_i.id.substring(0, 4) + '.' +
                    data_i.id.substring(4, 6) + '.' +
                    data_i.id.substring(6, 8);

                // contents 配列を <p> に変換
                let contentsHtml = '';
                data_i.contents.forEach(function (content) {
                    contentsHtml += `<p>${content}</p>`;
                });

                const listItem = `
                    <div class="contents_block" id="${data_i.id}">
                        <div class="notice-div">
                            <svg role="img" aria-label="蝶々">
                                <use href="#butterfly"></use>
                            </svg>${dateText}
                            ${contentsHtml}
                        </div>
                    </div>
                `;

                $('#notice').append(listItem);
            });
        });
    });
</script>
